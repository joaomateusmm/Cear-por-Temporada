<!doctype html>
<html>
  <head>
    <title>Teste API Profile Update</title>
  </head>
  <body>
    <h1>Teste de Atualização de Perfil</h1>
    <form id="profileForm">
      <label>ID do Proprietário:</label>
      <input type="text" id="ownerId" value="a1Y8Jmzakv9D2Nfossk5J" />

      <label>Nome Completo:</label>
      <input type="text" id="fullName" value="João Teste" />

      <label>Telefone:</label>
      <input type="text" id="phone" value="(85) 9 9999-9999" />

      <label>Instagram:</label>
      <input type="text" id="instagram" value="@joao" />

      <label>Website:</label>
      <input type="text" id="website" value="https://joao.com" />

      <label>Profile Image:</label>
      <input type="text" id="profileImage" value="/uploads/profiles/test.jpg" />

      <button type="submit">Testar API</button>
    </form>

    <div id="result"></div>

    <script>
      document
        .getElementById("profileForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const ownerId = document.getElementById("ownerId").value;
          const data = {
            fullName: document.getElementById("fullName").value,
            phone: document.getElementById("phone").value,
            instagram: document.getElementById("instagram").value || null,
            website: document.getElementById("website").value || null,
            profileImage: document.getElementById("profileImage").value || null,
          };

          console.log("Dados que serão enviados:", data);
          console.log(
            "URL da requisição:",
            `/api/proprietario/${ownerId}/profile`,
          );

          try {
            const response = await fetch(
              `/api/proprietario/${ownerId}/profile`,
              {
                method: "PUT",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
              },
            );

            console.log("Status da resposta:", response.status);

            const responseData = await response.json();
            console.log("Dados da resposta:", responseData);

            document.getElementById("result").innerHTML = `
                    <h3>Resultado:</h3>
                    <p>Status: ${response.status}</p>
                    <pre>${JSON.stringify(responseData, null, 2)}</pre>
                `;

            if (!response.ok) {
              throw new Error(responseData.error || "Erro na requisição");
            }
          } catch (error) {
            console.error("Erro:", error);
            document.getElementById("result").innerHTML = `
                    <h3>Erro:</h3>
                    <p>${error.message}</p>
                `;
          }
        });
    </script>
  </body>
</html>
